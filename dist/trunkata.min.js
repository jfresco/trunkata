/*! trunkata - v0.0.0 - 2012-09-22
* https://github.com/twolfson/trunkata
* Copyright (c) 2012 Todd Wolfson; Licensed MIT, GPL */
(function(a){function c(a){function b(){var a=this.$item}return b}function d(b){var c=a();return b.each(function(){var b=a(this);c=c.add(b);var e=b.children(),f=d(e);c=c.add(f)}),c}function e(a,b,c){var d=0,e=a.length-1,f=Math.floor((e+d)/2);while(c(b,a[f])!==0&&d<e)c(b,a[f])<0?e=f-1:c(b,a[f])>0&&(d=f+1),f=Math.floor((e+d)/2);return c(b,a[f])!==0?-1:f}function f(a,b){var c=a.css(b),d=parseInt(c,10);return d}function g(b){var c=a(b);this.$item=c}function i(c){var d;return typeof c!="string"?(c="trunkata",d=b.call(arguments)):d=b.call(arguments,1),this.each(function(){var b=a(this),e=b.data("_trunkata");return e||(e=new g(this),b.data("_trunkata",e)),h[c].apply(e,d)})}var b=[].slice;g.collectContents=d;var h={collectContents:function(){var a=this.$item,b=a.children(),c=d(b);return c},trunkata:function(a){function h(a){var c;g||(c=f(b,"height"),g=c<=d);if(g)return;var e=a.childNodes,i=e.length;while(i--)h(e[i]);if(!g){if(a.nodeType===3){var j=a.nodeValue,k=j.split(" "),l=k.length,m=document.createElement("span");m.className="trunkata-ellipsis",m.innerHTML="&hellip;",a.parentNode.appendChild(m);for(;l>=1;l--){a.nodeValue=k.slice(0,l).join(" "),c=f(b,"height"),g=c<=d;if(g)return}a.parentNode.removeChild(m)}a.parentNode.removeChild(a),c=f(b,"height"),g=c<=d}}var b=this.$item,c=b.children(),d=f(b,"line-height"),e=f(b,"height"),g=e<=d,i=b[0],j=i.childNodes,k=j.length;while(k--)h(j[k]);return this},truncate:function(){var a=b.call(arguments);return this.trunkata.apply(this,arguments)}};g.prototype=h,a.fn.trunkata=i})(jQuery);